<!DOCTYPE html>
<html lang="zxx" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mental Care</title>

    <!-- GOOGLE FONTS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">

    <!-- ICON SCOUT -->
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">

    <!-- STYLE SHEET -->
    <link rel="stylesheet" href="../css/common/style.css">
    <link rel="stylesheet" href="../css/test/my_result.css">

    <!-- =========== JAVASCRIPT ========== -->
    <script src="../javascript/common/base.js"></script>
    <script src="../javascript/test/my_result.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<!-- =========== NAVBAR ========== -->
<nav id="nav">
</nav>

<!-- =========== MEMBER ========== -->
<section id="member">
    <div class="container member__con">
        <div class="member__info">
            <div class="member__img">
                <img src="../images/son.png">
            </div>
            <div class="member__text">
                <div class="member__name">
                    <h3>손흥민</h3>
                    <div class="type">
                        <h4>선수</h4>
                    </div>
                </div>
                <h4>FW, 30살</h4>
                최근 업데이트 :<p th:text="${date}">2022.09.26</p>
                <table>
                    <tr>
                        <td>총 평균 : </td>
                        <td><p style="margin-left: 5px"  th:text="${totalAvg}"></p></td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="member__chart">
            <canvas id="doughnut" width="120" height="120"></canvas>
        </div>
    </div>
    <div class="line inside__large"></div>
</section>

<!-- =========== RESULT ========== -->
<section id="result">
    <div class="container result__container">
        <!-- result-header -->
        <div class="result__header">
            <div class="result__label">
                <div class="label-type">
                    <div class="label-color"></div>
                    <h4>양호</h4>
                </div>
                <div class="label-type">
                    <div class="label-color"></div>
                    <h4>보통</h4>
                </div>
                <div class="label-type">
                    <div class="label-color"></div>
                    <h4>심각</h4>
                </div>
            </div>
        </div>
        <!-- result-list -->


        <div class="result__list" th:each="diagnose : ${diagnoseList}">
            <script>
            var titleSet = new Array();
            var weightSet = new Array();
            var data_bar = new Array();
            var config_bar = new Array();
            </script>
            <article>
                <div class="result__box">
                    <div class="result__name">
                        <h3 th:text="${diagnose.diagnoseTitle}">관계</h3>
                        마지막 검사 : <p th:text="${date}"> 2022.09.26</p>
                        <table>
                            <tr>
                                <td><p style="margin-left: 30px;">평균 :</p></td>
                                <td><p style="margin-left: 3px;" th:text="${diagnose.diagnoseAvg}"> </p></td>
                            </tr>
                        </table>

                    </div>
                    <i class="uil uil-angle-down"></i>
                </div>
                <div class="result__chart">

                    <div th:each="question : ${diagnose.questionList}">
<!--                        <p th:text="${question.questionContext}"></p>-->
<!--                        <p th:text="${question.weight}"></p>-->
                        <script th:inline="javascript">
                            /* <![CDATA[ */
                            var title = /*[[${question.questionContext}]]*/;
                            var weight = /*[[${question.weight}]]*/;
                            titleSet.push(title);
                            weightSet.push(weight);
                            /* ]]> */
                        </script>
                    </div>
                    <canvas id="bar"></canvas>
                    <script th:inline="javascript">

                        data_bar = {
                            labels: titleSet,
                            datasets: [{
                                label: '스트레스 강도',
                                data: weightSet,
                                backgroundColor : [
                                    'rgba(105,81,255,0.6)'
                                ]
                            }]
                        };

                        config_bar = {
                            type: 'bar',
                            data: data_bar,
                            options: {
                                scales: {
                                    y: {
                                        beginAtZero: true
                                    }
                                }
                            }
                        }

                        const bar = new Chart(
                            document.getElementById('bar'),
                            config_bar
                        )
                    </script>


                </div>
            </article>

        </div>
    </div>
</section>


<script>
    const data = {
        datasets: [{
            label : '멘탈 상태',
            data: [300,50,100],
            backgroundColor: [
                '#1DBA84',
                '#EFB93A',
                '#FC5230'
            ],
            hoverOffset: 4
        }]
    };

    const config = {
        type: 'doughnut',
        data: data,
        options: {
            responsive: false
        }
    };

    const doughnut = new Chart(
        document.getElementById('doughnut'),
        config
    );
</script>
<!--<script th:inline="javascript">-->

<!--    const labels = ['경기전 불안감','어웨이 불안감','훈련 집중도','자신감','스트레스'];-->

<!--    const data_bar = {-->
<!--        labels: labels,-->
<!--        datasets: [{-->
<!--            label: '스트레스 강도',-->
<!--            data: [1,2,3,5,4],-->
<!--            backgroundColor : [-->
<!--                'rgba(105,81,255,0.6)'-->
<!--            ]-->
<!--        }]-->
<!--    };-->

<!--    const config_bar = {-->
<!--        type: 'bar',-->
<!--        data: data_bar,-->
<!--        options: {-->
<!--            scales: {-->
<!--                y: {-->
<!--                    beginAtZero: true-->
<!--                }-->
<!--            }-->
<!--        }-->
<!--    }-->

<!--    const bar = new Chart(-->
<!--        document.getElementById('bar'),-->
<!--        config_bar-->
<!--    )-->
<!--</script>-->

</body>
</html>